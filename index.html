<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Word Puzzle Game Plus</title>
  <style>
    :root{
      --bg:#f5f7fb;
      --card:#ffffff;
      --primary:#2c3e50;
      --accent:#3498db;
      --accent-2:#f39c12;
      --success:#27ae60;
      --danger:#e74c3c;
      --muted:#7f8c8d;
      --shadow:0 6px 18px rgba(0,0,0,.08);
      --radius:16px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0;
      font-family: ui-sans-serif, system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji", "Segoe UI Emoji";
      background: linear-gradient(180deg, #eef3ff 0%, var(--bg) 100%);
      color:#333;
      display:flex;
      align-items:flex-start;
      justify-content:center;
      padding:32px 20px;
    }
    .container{
      width:100%;
      max-width:980px;
      display:grid;
      grid-template-columns: 2fr 1fr;
      gap:20px;
    }
    @media (max-width: 900px){
      .container{grid-template-columns:1fr}
    }
    .card{
      background:var(--card);
      border-radius:var(--radius);
      box-shadow:var(--shadow);
      padding:24px;
    }
    h1{
      margin:0 0 10px;
      color:var(--primary);
      letter-spacing:.3px;
      font-size:clamp(24px,3vw,32px);
      text-align:left;
    }
    .sub{color:var(--muted); margin:0 0 18px; font-size:14px}
    .statusbar{
      display:flex; flex-wrap:wrap; gap:10px; align-items:center;
      background:#f3f6fb; border-radius:12px; padding:12px 14px; margin-bottom:16px;
      font-size:14px;
    }
    .statusbar .tag{background:white; border:1px dashed #e0e6ef; padding:6px 10px; border-radius:999px}
    .grid{
      display:grid; gap:14px;
    }
    .puzzle-area{
      padding:18px;
      background:#f9fbfe;
      border:1px solid #e8eef8;
      border-radius:12px;
      min-height:120px;
    }
    .word-display{
      font-size:clamp(20px,4vw,28px);
      letter-spacing:6px;
      text-align:center;
      margin:12px 0 6px;
      font-weight:800;
      color:var(--primary);
    }
    .hint{color:var(--muted); font-style:italic; text-align:center; min-height:22px}
    #message{
      min-height:22px; font-weight:700; text-align:center; margin:4px 0 8px;
    }
    .controls{
      display:flex; gap:10px; flex-wrap:wrap; align-items:center
    }
    input[type="text"]{
      flex:1 1 220px;
      padding:12px 14px;
      border:1px solid #dfe7f2;
      border-radius:12px;
      outline:none;
      transition:border-color .2s, box-shadow .2s;
      font-size:16px;
      background:#fff;
    }
    input[type="text"]:focus{
      border-color:#b6cff7;
      box-shadow:0 0 0 4px rgba(66,133,244,.12);
    }
    button{
      padding:12px 14px;
      border:0;
      border-radius:12px;
      font-weight:700;
      cursor:pointer;
      transition:transform .06s ease, opacity .15s ease, background-color .2s ease;
      color:#fff;
    }
    button:active{ transform: translateY(1px); }
    .btn-primary{ background:var(--accent); }
    .btn-primary:hover{ opacity:.92; }
    .btn-hint{ background:var(--accent-2); }
    .btn-hint:hover{ opacity:.93; }
    .btn-neutral{ background:#64748b; }
    .btn-neutral:hover{ opacity:.95; }
    .pill{
      display:inline-flex; align-items:center; gap:8px;
      background:#eef4ff; color:#24477d; padding:6px 10px; border-radius:999px;
      font-weight:700; font-size:13px;
    }
    .score-line{display:flex; gap:10px; align-items:center; flex-wrap:wrap; margin:8px 0 0}
    .score-line .sep{opacity:.25}
    /* Sidebar */
    .aside h3{margin:0 0 10px; color:var(--primary)}
    .aside .section{margin-bottom:18px}
    .leaderboard{
      background:#fbfdff; border:1px solid #e8eef8; border-radius:12px; padding:14px;
    }
    .leaderboard ol{margin:10px 0 0 20px; padding:0}
    .leaderboard li{padding:4px 0}
    .muted{color:var(--muted); font-size:13px}
    .banner{
      background:linear-gradient(92deg,#e8f1ff,#fff2df);
      border:1px solid #e6edf8;
      border-radius:12px; padding:10px 12px; font-size:14px; color:#344767;
    }
    .success{ color:var(--success); }
    .danger{ color:var(--danger); }
    .sr-only{position:absolute;width:1px;height:1px;padding:0;margin:-1px;overflow:hidden;clip:rect(0,0,0,0);white-space:nowrap;border:0;}
  </style>
</head>
<body>
  <div class="container">
    <!-- Main Game Card -->
    <section class="card">
      <h1>Word Puzzle Game <span class="pill" aria-hidden="true">Plus</span></h1>
      <p class="sub">Guess the original word. Use hints if you must (they cost points). Every 3 solved puzzles triggers a <strong>bonus round</strong> (score √ó2).</p>

      <div class="statusbar" aria-live="polite">
        <span class="tag">Score: <strong id="score">0</strong></span>
        <span class="tag">Solved: <strong id="solved">0</strong></span>
        <span class="tag">Bonus at: <strong id="next-bonus">3</strong></span>
      </div>

      <div class="grid">
        <div class="puzzle-area" aria-describedby="message">
          <div id="message" class="" role="status" aria-live="polite"></div>
          <div class="word-display" aria-label="scrambled word">
            <span id="scrambled-word"></span>
          </div>
          <div id="hint" class="hint"></div>
        </div>

        <div class="controls" role="group" aria-label="game controls">
          <label class="sr-only" for="guess-input">Your guess</label>
          <input id="guess-input" type="text" placeholder="Your guess‚Ä¶" autocomplete="off" />
          <button id="submit-guess" class="btn-primary" aria-label="Submit guess">Submit</button>
          <button id="hint-btn" class="btn-hint" aria-label="Get a hint">Hint</button>
          <button id="new-puzzle" class="btn-neutral" aria-label="Load new puzzle">New Puzzle</button>
          <button id="reset-game" class="btn-neutral" aria-label="Reset game (score and progress)">Reset</button>
        </div>

        <div class="banner" id="info-banner">
          Pro tip: Hints deduct <strong>2</strong> points. Solving with a hint awards fewer points than solving directly.
        </div>
      </div>
    </section>

    <!-- Sidebar: Leaderboard & Help -->
    <aside class="card aside">
      <div class="section">
        <h3>üèÜ Leaderboard</h3>
        <p class="muted">Top 3 scores (saved in your browser).</p>
        <div id="leaderboard" class="leaderboard">
          <ol id="leaderboard-list"><li class="muted">No scores yet ‚Äî be the first!</li></ol>
        </div>
      </div>

      <div class="section">
        <h3>‚ÑπÔ∏è Rules</h3>
        <ul class="muted" style="margin:8px 0 0 18px">
          <li>Correct without hint: +10 points</li>
          <li>Hint use: ‚àí2 points immediately, and reduced award (+5)</li>
          <li>Every 3 solved puzzles: <strong>Bonus</strong> (score √ó2)</li>
          <li>Reset clears score & progress (leaderboard remains)</li>
        </ul>
      </div>
    </aside>
  </div>

  <script>
    // ---------------------------
    // Data: Word bank (JSON-ish)
    // ---------------------------
    const wordBank = {
      "words": [
        {"word":"javascript","hint":"The language this game is written in"},
        {"word":"html","hint":"Markup language for the web"},
        {"word":"css","hint":"Stylesheet language for presentation"},
        {"word":"algorithm","hint":"Step-by-step recipe to solve a problem"},
        {"word":"variable","hint":"A named container for data"},
        {"word":"function","hint":"A reusable block of code"},
        {"word":"browser","hint":"Software used to access the web"},
        {"word":"debugging","hint":"Finding and fixing errors"},
        {"word":"framework","hint":"A platform for building apps"},
        {"word":"responsive","hint":"Adapts to different screen sizes"}
      ]
    };

    // ---------------------------
    // State
    // ---------------------------
    let currentWord = "";
    let scrambledWord = "";
    let currentHint = "";
    let score = 0;
    let puzzlesSolved = 0;
    let hintUsed = false;

    // ---------------------------
    // DOM
    // ---------------------------
    const scrambledWordEl = document.getElementById('scrambled-word');
    const hintEl = document.getElementById('hint');
    const messageEl = document.getElementById('message');
    const guessInput = document.getElementById('guess-input');
    const scoreEl = document.getElementById('score');
    const solvedEl = document.getElementById('solved');
    const nextBonusEl = document.getElementById('next-bonus');
    const leaderboardListEl = document.getElementById('leaderboard-list');

    // ---------------------------
    // Utilities
    // ---------------------------
    function scrambleWord(word){
      const letters = word.split('');
      for(let i=letters.length-1; i>0; i--){
        const j = Math.floor(Math.random()*(i+1));
        [letters[i], letters[j]] = [letters[j], letters[i]];
      }
      return letters.join('');
    }

    function showMessage(msg, type='danger'){
      messageEl.textContent = msg;
      messageEl.className = type === 'danger' ? 'danger' : 'success';
      // Clear success messages after a short time for better UX
      if(type !== 'danger'){
        setTimeout(()=>{ if(messageEl.className!=='danger') messageEl.textContent=''; }, 3000);
      }
    }

    function safeParse(json, fallback){
      try{ return JSON.parse(json); }catch{ return fallback; }
    }

    function updateNextBonusIndicator(){
      const remainder = puzzlesSolved % 3;
      const nextAt = remainder === 0 ? 3 : (3 - remainder);
      nextBonusEl.textContent = nextAt;
    }

    // ---------------------------
    // Leaderboard
    // ---------------------------
    function getLeaderboard(){
      const raw = localStorage.getItem('leaderboard');
      const arr = safeParse(raw, []);
      return Array.isArray(arr) ? arr : [];
    }

    function setLeaderboard(arr){
      localStorage.setItem('leaderboard', JSON.stringify(arr));
    }

    function displayLeaderboard(list){
      if(!list || list.length === 0){
        leaderboardListEl.innerHTML = `<li class="muted">No scores yet ‚Äî be the first!</li>`;
        return;
      }
      leaderboardListEl.innerHTML = list.map((s, i)=> `<li><strong>${s}</strong>${i===0?' ü•á': i===1?' ü•à': i===2?' ü•â':''}</li>`).join('');
    }

    function updateLeaderboard(currentScore){
      let leaderboard = getLeaderboard();
      leaderboard.push(currentScore);
      leaderboard.sort((a,b)=> b-a);
      leaderboard = leaderboard.slice(0,3);
      setLeaderboard(leaderboard);
      displayLeaderboard(leaderboard);
    }

    // ---------------------------
    // Game core
    // ---------------------------
    function newPuzzle(){
      hintUsed = false;
      hintEl.textContent = '';
      messageEl.textContent = '';
      guessInput.value = '';

      // Pick a word at random
      const idx = Math.floor(Math.random()*wordBank.words.length);
      currentWord = wordBank.words[idx].word.toLowerCase();
      currentHint = wordBank.words[idx].hint;

      // Ensure scrambled is not identical to original
      let attempt = currentWord;
      let safety = 0;
      while(attempt === currentWord && safety < 20){
        attempt = scrambleWord(currentWord);
        safety++;
      }
      scrambledWord = attempt;
      scrambledWordEl.textContent = scrambledWord;
      scrambledWordEl.style.color = 'var(--primary)';
      updateNextBonusIndicator();
    }

    function checkGuess(){
      const guess = guessInput.value.trim().toLowerCase();
      if(!guess){
        showMessage("Please enter a guess!");
        return;
      }
      if(guess === currentWord){
        // Correct!
        let points = hintUsed ? 5 : 10; // direct solve vs with hint
        score += points;
        puzzlesSolved++;

        // Bonus: every 3 solved puzzles, double the score
        if (puzzlesSolved % 3 === 0){
          score *= 2;
          showMessage("üéâ Bonus Round! Score doubled!", "success");
        } else {
          showMessage(`Correct! +${points} points`, 'success');
        }

        // Reflect UI
        scoreEl.textContent = score;
        solvedEl.textContent = puzzlesSolved;
        updateNextBonusIndicator();

        // Update leaderboard after each correct solve
        updateLeaderboard(score);

        // Celebrate by flashing the solved word briefly
        scrambledWordEl.textContent = currentWord;
        scrambledWordEl.style.color = 'var(--success)';

        // Queue next puzzle
        setTimeout(newPuzzle, 1200);
      }else{
        showMessage("Incorrect, try again!");
        guessInput.select();
      }
    }

    function showHint(){
      if(!hintUsed){
        hintEl.textContent = currentHint;
        score = Math.max(0, score - 2); // immediate cost for hint
        scoreEl.textContent = score;
        hintUsed = true;
        showMessage("Hint shown (‚àí2 points).", "success");
      }else{
        showMessage("You've already used your hint for this puzzle!");
      }
    }

    function resetGame(){
      score = 0;
      puzzlesSolved = 0;
      hintUsed = false;

      scoreEl.textContent = score;
      solvedEl.textContent = puzzlesSolved;
      updateNextBonusIndicator();

      messageEl.textContent = "Game reset!";
      messageEl.className = "success";
      scrambledWordEl.textContent = "";
      hintEl.textContent = "";
      guessInput.value = "";
      guessInput.focus();
    }

    // ---------------------------
    // Init
    // ---------------------------
    document.addEventListener('DOMContentLoaded', ()=>{
      // Wire up events
      document.getElementById('submit-guess').addEventListener('click', checkGuess);
      document.getElementById('hint-btn').addEventListener('click', showHint);
      document.getElementById('new-puzzle').addEventListener('click', newPuzzle);
      document.getElementById('reset-game').addEventListener('click', resetGame);
      guessInput.addEventListener('keypress', e => { if(e.key === 'Enter') checkGuess(); });

      // Load leaderboard
      displayLeaderboard(getLeaderboard());

      // First puzzle
      newPuzzle();
      guessInput.focus();
    });
  </script>
</body>
</html>
